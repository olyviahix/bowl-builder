{"version":3,"file":"use-google-sheets.cjs.production.min.js","sources":["../src/types.ts","../src/index.tsx"],"sourcesContent":["export interface SheetsOption {\n  id: string;\n  headerRowIndex?: number;\n}\nexport interface HookOptions {\n  apiKey: string;\n  sheetId: string;\n  sheetsOptions?: SheetsOption[];\n}\nexport interface Sheet {\n  id: string;\n  data: Array<object>;\n}\nexport interface ApiResponse {\n  url: string;\n  status: number;\n  statusText: string;\n}\nexport interface ErrorResponse {\n  response: ApiResponse;\n}\nexport interface HookState {\n  loading: boolean;\n  called: boolean;\n  error: null | ErrorResponse;\n  data: Sheet[];\n  refetch: () => void;\n}\nexport enum ActionTypes {\n  loading = 'LOADING',\n  error = 'ERROR',\n  success = 'SUCCESS',\n  called = 'CALLED',\n}\nexport type Action =\n  | { type: ActionTypes.loading; payload: HookState['loading'] }\n  | { type: ActionTypes.called; payload: HookState['called'] }\n  | { type: ActionTypes.error; payload: HookState['error'] }\n  | { type: ActionTypes.success; payload: HookState['data'] };\n","import * as React from 'react';\nimport GoogleSheetsMapper from 'google-sheets-mapper';\n\nimport { HookOptions, HookState, ActionTypes, Action } from './types';\n\nconst initialState: HookState = {\n  loading: true,\n  error: null,\n  data: [],\n  called: false,\n  refetch: () => {},\n};\n\nfunction reducer(state: HookState, action: Action): HookState {\n  switch (action.type) {\n    case ActionTypes.loading:\n      return { ...state, loading: action.payload };\n    case ActionTypes.error:\n      return { ...state, error: action.payload };\n    case ActionTypes.success:\n      return { ...state, data: action.payload };\n    case ActionTypes.called:\n      return { ...state, called: action.payload };\n    default:\n      return state;\n  }\n}\n\nconst useGoogleSheets = ({\n  apiKey,\n  sheetId,\n  sheetsOptions = [],\n}: HookOptions): HookState => {\n  const [state, dispatch] = React.useReducer(reducer, initialState);\n  const sheets = React.useRef(sheetsOptions);\n\n  const fetchData = React.useCallback(async () => {\n    dispatch({ type: ActionTypes.loading, payload: true });\n    dispatch({ type: ActionTypes.called, payload: false });\n    dispatch({ type: ActionTypes.error, payload: null });\n    dispatch({ type: ActionTypes.success, payload: [] });\n    try {\n      const mappedData = await GoogleSheetsMapper.fetchGoogleSheetsData({\n        apiKey,\n        sheetId,\n        sheetsOptions: sheets.current,\n      });\n\n      dispatch({\n        type: ActionTypes.success,\n        payload: mappedData,\n      });\n    } catch (error) {\n      dispatch({ type: ActionTypes.error, payload: error });\n    } finally {\n      dispatch({ type: ActionTypes.loading, payload: false });\n      dispatch({ type: ActionTypes.called, payload: true });\n    }\n  }, [apiKey, sheetId]);\n\n  const refetch = React.useCallback(() => {\n    if (state.called) {\n      fetchData();\n    }\n  }, [fetchData, state.called]);\n\n  React.useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  return {\n    loading: state.loading,\n    error: state.error,\n    data: state.data,\n    called: state.called,\n    refetch,\n  };\n};\n\nexport default useGoogleSheets;\n"],"names":["ActionTypes","initialState","loading","error","data","called","refetch","reducer","state","action","type","payload","success","apiKey","sheetId","sheetsOptions","React","dispatch","sheets","fetchData","_context","GoogleSheetsMapper","fetchGoogleSheetsData","current"],"mappings":"0EA4BYA,m8NAAZ,SAAYA,GACVA,oBACAA,gBACAA,oBACAA,kBAJF,CAAYA,IAAAA,OCvBZ,IAAMC,EAA0B,CAC9BC,SAAS,EACTC,MAAO,KACPC,KAAM,GACNC,QAAQ,EACRC,QAAS,cAGX,SAASC,EAAQC,EAAkBC,GACjC,OAAQA,EAAOC,MACb,KAAKV,EAAYE,QACf,YAAYM,GAAON,QAASO,EAAOE,UACrC,KAAKX,EAAYG,MACf,YAAYK,GAAOL,MAAOM,EAAOE,UACnC,KAAKX,EAAYY,QACf,YAAYJ,GAAOJ,KAAMK,EAAOE,UAClC,KAAKX,EAAYK,OACf,YAAYG,GAAOH,OAAQI,EAAOE,UACpC,QACE,OAAOH,mBAIW,gBACtBK,IAAAA,OACAC,IAAAA,YACAC,cAAAA,aAAgB,OAEUC,aAAiBT,EAASN,GAA7CO,OAAOS,OACRC,EAASF,SAAaD,GAEtBI,EAAYH,0BAAkB,aAAA,6BAAA,OAAA,sBAAA,OAAA,OAClCC,EAAS,CAAEP,KAAMV,EAAYE,QAASS,SAAS,IAC/CM,EAAS,CAAEP,KAAMV,EAAYK,OAAQM,SAAS,IAC9CM,EAAS,CAAEP,KAAMV,EAAYG,MAAOQ,QAAS,OAC7CM,EAAS,CAAEP,KAAMV,EAAYY,QAASD,QAAS,KAJbS,SAAAA,SAMPC,EAAmBC,sBAAsB,CAChET,OAAAA,EACAC,QAAAA,EACAC,cAAeG,EAAOK,UATQ,OAYhCN,EAAS,CACPP,KAAMV,EAAYY,QAClBD,iBAd8BS,UAAA,MAAA,QAAAA,UAAAA,gBAiBhCH,EAAS,CAAEP,KAAMV,EAAYG,MAAOQ,eAjBJ,QAAA,OAAAS,UAmBhCH,EAAS,CAAEP,KAAMV,EAAYE,QAASS,SAAS,IAC/CM,EAAS,CAAEP,KAAMV,EAAYK,OAAQM,SAAS,iBApBd,QAAA,UAAA,8CAsBjC,CAACE,EAAQC,IAENR,EAAUU,eAAkB,WAC5BR,EAAMH,QACRc,MAED,CAACA,EAAWX,EAAMH,SAMrB,OAJAW,aAAgB,WACdG,MACC,CAACA,IAEG,CACLjB,QAASM,EAAMN,QACfC,MAAOK,EAAML,MACbC,KAAMI,EAAMJ,KACZC,OAAQG,EAAMH,OACdC,QAAAA"}